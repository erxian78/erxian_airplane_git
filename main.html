<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="main.css" type="text/css" />
    <title>login_register</title>
</head>
<body>
<header>
    <div></div>
</header>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript">
    $(function(){
        $.get("seat.php", function (data) {
            let allResults = JSON.parse(data);
            let seatResults = JSON.parse(allResults.results);
            let m = 10;
            let n = 6;
            let seatString = "<table border=\"0\"><tr><td width=\"50px\" align=\"center\"></td>";
            for(let i = 0;i < n;i ++)
            {
                seatString += "<td width=\"50px\" align=\"center\">";
                let column = String.fromCharCode(65+i);
                seatString += column;
                seatString += "</td>";
            }
            let i = 0;
            for(;i < m;i ++)
            {
                seatString += "<tr align=\"center\">";
                seatString += "<td width=\"50px\">" + i + "</td>";
                for(let j = 0;j < n;j ++){
                    seatString += "<td width=\"50px\" class='seat' id=" + i + "-" + j + " onclick='reserveSeat(this)'>";
                    seatString += seatResults[i * 6 + j];
                    seatString += "</td>";
                }
                seatString += "</tr>";
            }
            seatString += "</table>";
            $("body").append(seatString);
            let infoString = "<p>the total number of seats:&nbsp;" + seatResults.length + "</p>";
            infoString += "<p>the total number of purchased:&nbsp;" + allResults.purchase + "</p>";
            infoString += "<p>the total number of reserved:&nbsp;" + allResults.reserved + "</p>";
            infoString += "<p>the total number of free:&nbsp;" + allResults.free + "</p>";
            $("body").append(infoString);
        });
    });

    reserveSeat = (self) => {
        console.log("click", self.id);
        let row = self.id.split('-')[0];
        let column = self.id.split('-')[1];
        $.post("update-seat.php", { row: row, column: column, user_id: 1, status: "purchase" }, function (data) {
            console.log("data", data);
        });
    }
</script>
</body>
</html>